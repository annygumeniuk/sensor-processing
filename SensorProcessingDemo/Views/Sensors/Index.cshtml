@model SensorProcessingDemo.Models.Sensor

<head>    
    <script src="https://cdn.canvasjs.com/canvasjs.min.js"></script>
    <script>
        window.onload = function () {
            // Parse the JSON data from the ViewBag
            var groupedData = JSON.parse('@Html.Raw(ViewBag.GroupedDataPoints)');

            // Loop through each sensor type and create a separate chart
            for (var sensorType in groupedData) {
                var dataPoints = groupedData[sensorType].map(function (point) {
                    return {
                        x: new Date(point.dateTime),
                        y: point.Value
                    };
                });

                // Create a new chart container for each sensor
                var chartContainer = document.createElement("div");
                chartContainer.id = sensorType + "ChartContainer";
                chartContainer.style.height = "300px"; // 370 works good
                chartContainer.style.width = "98%";
                document.body.appendChild(chartContainer); // Append to body or any other section

                // Initialize and render each chart
                var chart = new CanvasJS.Chart(chartContainer.id, {
                    animationEnabled: true,
                    title: {
                        text: sensorType + " Sensor Data"
                    },
                    axisX: {
                        title: "Date & Time",
                        valueFormatString: "DD MMM hh:mm TT"
                    },
                    axisY: {
                        title: sensorType + " Value",
                        includeZero: false
                    },
                    data: [{
                        type: "line",
                        name: sensorType,
                        showInLegend: true,
                        dataPoints: dataPoints
                    }]
                });

                chart.render();
            }
        }
    </script>    
</head>

<body>
    <!-- Containers will be dynamically created for each sensor -->
</body>
